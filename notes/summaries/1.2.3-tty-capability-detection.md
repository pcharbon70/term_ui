# Summary: Task 1.2.3 - TTY Capability Detection

## Branch
`feature/1.2.3-tty-capability-detection` (from `multi-renderer`)

## What Was Implemented

Implemented `detect_capabilities/0` to detect terminal capabilities when falling back to TTY mode. This provides graceful degradation information for the TTY backend.

### Files Modified
- `lib/term_ui/backend/selector.ex` - Implemented `detect_capabilities/0` and private helper functions
- `test/term_ui/backend/selector_test.exs` - Added 18 new tests (46 total)
- `notes/features/1.2.3-tty-capability-detection.md` - Working plan
- `notes/planning/multi-renderer/phase-01-backend-selector.md` - Marked task complete

### Implementation Details

**`detect_capabilities/0`**:
- Returns a map with `:colors`, `:unicode`, `:dimensions`, `:terminal` keys
- Combines results from four private detection functions

**`detect_color_depth/0`**:
- Checks `$COLORTERM` first (most reliable for true color)
- Falls back to `$TERM` pattern matching
- Priority: `truecolor/24bit` → `-direct` → `-256color` → basic terminal → monochrome

**`detect_unicode_support/0`**:
- Checks locale environment variables: `$LC_ALL` > `$LC_CTYPE` > `$LANG`
- Case-insensitive check for "UTF-8" or "UTF8"

**`detect_dimensions/0`**:
- Uses `:io.columns/0` and `:io.rows/0`
- Returns `{rows, cols}` tuple or `nil` if unavailable

**`detect_terminal_presence/0`**:
- Uses `:io.getopts/0` to check for `:terminal` option
- Returns boolean

### Return Values

```elixir
# Capabilities map
%{
  colors: :true_color | :color_256 | :color_16 | :monochrome,
  unicode: boolean(),
  dimensions: {rows, cols} | nil,
  terminal: boolean()
}
```

## Test Results
All 46 tests pass:
- 28 existing tests for module structure, documentation, types, core selection
- 18 new tests for capability detection:
  - `detect_capabilities/0` structure tests (5)
  - Color depth detection tests (7)
  - Unicode detection tests (4)
  - Dimension detection tests (1)
  - Terminal presence tests (1)

## Tasks Completed
- [x] 1.2.3.1 Implement private `detect_capabilities/0` returning capabilities map
- [x] 1.2.3.2 Detect color depth via `$COLORTERM` and `$TERM` patterns
- [x] 1.2.3.3 Detect Unicode support via `$LANG` environment variable
- [x] 1.2.3.4 Detect terminal dimensions via `:io.columns/0`, `:io.rows/0`
- [x] 1.2.3.5 Detect terminal presence via `:io.getopts/0` `:terminal` key
- [x] 1.2.3.6 Return map with keys: `:colors`, `:unicode`, `:dimensions`, `:terminal`

## Next Steps
- Task 1.2.4: Implement Explicit Selection tests
- Section 1.3: Create Backend State Module
