# Summary: 2.6 Framerate Limiter

## Overview

Implemented `FramerateLimiter` GenServer that caps rendering to a maximum FPS (default 60, configurable to 30 or 120). The module schedules frame ticks at regular intervals, maintains an atomic dirty flag for concurrent access, and only renders when the buffer is dirty. This creates smooth animation while being efficient.

## Implementation

### Files Created
- `lib/term_ui/renderer/framerate_limiter.ex` - Core framerate limiter module (~350 lines)
- `test/term_ui/renderer/framerate_limiter_test.exs` - Comprehensive test suite (22 tests)
- `notes/features/2.6-framerate-limiter.md` - Feature planning document

### Key Features

1. **Frame Timer**
   - `Process.send_after/3` for interval scheduling
   - Configurable FPS (30, 60, 120)
   - Drift compensation for consistent frame rate
   - Pause/resume for application backgrounding

2. **Dirty Flag Management**
   - Atomic flag using `:atomics` module
   - Lock-free concurrent access
   - Multiple writes coalesce into single render

3. **Render Scheduling**
   - Tick handler checks dirty flag
   - Skips clean frames
   - Immediate mode bypasses frame timing
   - Frame statistics tracking

4. **Performance Monitoring**
   - Timing instrumentation
   - Actual FPS calculation
   - Average render time tracking
   - Slow frame detection

### API

```elixir
# Start with default 60 FPS
{:ok, pid} = FramerateLimiter.start_link(render_callback: fn -> :ok end)

# Start with custom FPS
{:ok, pid} = FramerateLimiter.start_link(fps: 120, render_callback: fn -> :ok end)

# Dirty flag management
FramerateLimiter.mark_dirty()
FramerateLimiter.clear_dirty()
FramerateLimiter.dirty?()

# Immediate render (bypasses frame timing)
FramerateLimiter.render_immediate()

# Pause/resume
FramerateLimiter.pause()
FramerateLimiter.resume()
FramerateLimiter.paused?()

# FPS configuration
FramerateLimiter.set_fps(120)
FramerateLimiter.get_fps()

# Performance metrics
stats = FramerateLimiter.stats()
# Returns:
# %{
#   rendered_frames: 100,
#   skipped_frames: 50,
#   total_frames: 150,
#   actual_fps: 59.8,
#   avg_render_time_us: 1234.5,
#   slow_frames: 2
# }

FramerateLimiter.reset_stats()
```

### FPS Intervals

| FPS | Interval (ms) |
|-----|---------------|
| 30  | 33.33         |
| 60  | 16.67         |
| 120 | 8.33          |

## Test Results

- 22 tests, 0 failures
- Total project tests: 648
- Credo strict mode: No issues

## Technical Notes

- Uses monotonic time for accurate measurement
- Drift compensation adjusts next interval based on actual elapsed time
- Keeps last 60 render times and frame timestamps for statistics
- Slow frame detected when render time exceeds target interval
- Render callback is invoked on each tick when dirty

## Next Steps

Section 2.7: Integration Tests
