# Summary: Section 6.11.1 LogViewer Widget

## Overview

Implemented a LogViewer widget for displaying real-time logs with virtual scrolling, search, filtering, syntax highlighting, bookmarking, and selection capabilities.

## Features Implemented

### 6.11.1.1 Virtual Scrolling
- Only renders visible lines plus buffer for efficiency
- Handles datasets with configurable max_lines (default 100,000)
- Visible range calculation based on scroll offset and viewport height
- Smooth scrolling with keyboard navigation

### 6.11.1.2 Tail Mode
- Auto-scroll to bottom when new lines are added
- Toggle with 't' key
- Automatically disabled on manual scroll up
- Visual indicator "TAIL" in status bar

### 6.11.1.3 Search with Regex
- '/' key starts search input mode
- Supports regex patterns with fallback to literal
- n/N navigates between matches
- Highlights current match in yellow
- Shows match count in status bar

### 6.11.1.4 Syntax Highlighting
- Automatic log level detection (DEBUG, INFO, WARN, ERROR, CRITICAL, etc.)
- Color-coded levels (green=INFO, yellow=WARN, red=ERROR, etc.)
- Timestamp extraction from ISO 8601 format
- Source/module extraction from [brackets]
- Support for custom parser functions

### 6.11.1.5 Filtering
- Filter by log levels (e.g., only ERROR and CRITICAL)
- Filter by source pattern
- Filter by message pattern (regex)
- Filter to bookmarked lines only
- 'f' key toggles filter input mode

### 6.11.1.6 Line Bookmarking
- 'b' toggles bookmark on current line
- 'B' jumps to next bookmark (wraps around)
- Bookmark indicator (*) rendered next to line
- get_bookmarks/1 returns sorted bookmark list

### 6.11.1.7 Selection and Copy
- Space starts/extends selection
- Escape clears selection
- 'y' triggers on_copy callback with selected text
- Visual highlight for selected lines
- get_selected_text/1 returns selected content

### 6.11.1.8 Wrap/Truncate
- 'w' toggles wrap mode
- Truncation adds "..." for long lines
- Respects viewport width

## API

### Props
```elixir
LogViewer.new(
  lines: [String.t()],
  max_lines: 100_000,
  tail_mode: true,
  wrap_lines: false,
  show_line_numbers: true,
  show_timestamps: false,
  show_levels: true,
  highlight_levels: true,
  on_select: fn lines -> ... end,
  on_copy: fn text -> ... end,
  parser: &custom_parser/1
)
```

### Public Functions
- `add_line/2` - Add single log line
- `add_lines/2` - Add multiple lines (respects max_lines)
- `clear/1` - Clear all lines
- `get_selected_text/1` - Get selected text
- `set_filter/2` - Apply filter specification
- `clear_filter/1` - Remove active filter
- `search/2` - Start search with pattern
- `goto_line/2` - Jump to specific line
- `get_bookmarks/1` - Get bookmarked line indices
- `get_search_matches/1` - Get search match indices
- `tail_mode?/1` - Check if tail mode enabled
- `line_count/1` - Total line count
- `visible_line_count/1` - Filtered line count

### Filter Specification
```elixir
%{
  levels: [:error, :warning] | nil,
  source: "MyModule" | nil,
  pattern: ~r/error/ | nil,
  bookmarks_only: false
}
```

## Files Created/Modified

### New Files
- `lib/term_ui/widgets/log_viewer.ex` - LogViewer widget implementation (~970 lines)
- `test/term_ui/widgets/log_viewer_test.exs` - Comprehensive tests (66 tests)
- `examples/log_viewer/` - Example application
  - `mix.exs`
  - `lib/log_viewer/application.ex`
  - `lib/log_viewer/app.ex`
- `notes/features/6.11.1-logviewer-widget.md` - Planning document
- `notes/summaries/6.11.1-logviewer-widget-summary.md` - This summary

## Test Coverage

66 tests covering:
- Props creation (2 tests)
- Initialization (4 tests)
- Level detection (7 tests)
- Source detection (3 tests)
- Navigation (8 tests)
- Search (8 tests)
- Filtering (5 tests)
- Bookmarking (3 tests)
- Tail mode (3 tests)
- Wrap mode (1 test)
- Selection (5 tests)
- add_line/add_lines (4 tests)
- clear (2 tests)
- line_count/visible_line_count (2 tests)
- Rendering (3 tests)
- goto_line (3 tests)
- Edge cases (3 tests)

## Example Application

The example demonstrates:
- Real-time log generation simulation
- All log levels with color coding
- Tail mode for live monitoring
- Search and filter capabilities
- Bookmarking workflow
- Add/clear log controls

## Usage Example

```elixir
# Create log viewer with tail mode
props = LogViewer.new(
  lines: initial_logs,
  tail_mode: true,
  highlight_levels: true,
  max_lines: 50_000
)

{:ok, state} = LogViewer.init(props)

# Add new log lines
state = LogViewer.add_lines(state, ["INFO: New message", "ERROR: Something failed"])

# Search for errors
state = LogViewer.search(state, "ERROR|CRITICAL")

# Filter to errors only
filter = %{levels: [:error, :critical], source: nil, pattern: nil, bookmarks_only: false}
state = LogViewer.set_filter(state, filter)

# Get selected text for copy
text = LogViewer.get_selected_text(state)
```

## Branch

All changes are on the `feature/6.11.1-logviewer-widget` branch.
