# Summary: Section 6.2 - Navigation Widgets

## Overview

Implemented three navigation widgets for TermUI: Tabs, Menu, and Context Menu. These widgets provide essential UI patterns for organizing content and actions in terminal applications.

## Implemented Components

### 1. Tabs Widget (`lib/term_ui/widgets/tabs.ex`)

A tabbed interface for switching between content panels.

**Features:**
- Tab bar with visual indicators for selected/focused tabs
- Keyboard navigation (Left/Right, Home/End, Enter/Space)
- Mouse click selection
- Disabled tab support
- Closeable tabs
- Dynamic tab management (add/remove)

**API:**
```elixir
Tabs.new(tabs: [...], selected: :home, on_change: fn id -> ... end)
Tabs.get_selected(state)
Tabs.select(state, tab_id)
Tabs.add_tab(state, tab)
Tabs.remove_tab(state, tab_id)
```

### 2. Menu Widget (`lib/term_ui/widgets/menu.ex`)

Hierarchical menu with multiple item types.

**Item Types:**
- `action` - Selectable action items with optional shortcuts
- `submenu` - Expandable nested menus
- `separator` - Visual dividers
- `checkbox` - Toggleable items with state

**Features:**
- Full keyboard navigation (arrows, Enter, Escape)
- Submenu expansion/collapse
- Checkbox toggling with callbacks
- Shortcut display aligned right
- Disabled item support

**API:**
```elixir
Menu.action(id, label, shortcut: "Ctrl+N")
Menu.submenu(id, label, children)
Menu.separator()
Menu.checkbox(id, label, checked: true)
Menu.expand(state, submenu_id)
Menu.checked?(state, item_id)
```

### 3. Context Menu Widget (`lib/term_ui/widgets/context_menu.ex`)

Floating menu that appears at a specific position.

**Features:**
- Position-aware rendering
- Auto-close on selection or escape
- Click-outside-to-close behavior
- Z-order support (z: 100 for overlays)
- Visibility control

**API:**
```elixir
ContextMenu.new(items: [...], position: {x, y}, on_select: fn -> ... end)
ContextMenu.visible?(state)
ContextMenu.show(state) / ContextMenu.hide(state)
ContextMenu.set_position(state, {x, y})
```

## Test Coverage

Total: 84 new tests across all three widgets

### Tabs Tests (25 tests)
- Tab creation and props
- Keyboard navigation (all keys)
- Mouse interaction
- Public API functions
- Render output verification

### Menu Tests (38 tests)
- Item constructors (action, submenu, separator, checkbox)
- Keyboard navigation
- Submenu expansion/collapse
- Checkbox toggling
- Mouse interaction
- Render output

### Context Menu Tests (21 tests)
- Props creation
- Keyboard navigation
- Mouse interaction (inside/outside clicks)
- Visibility management
- Disabled items handling
- Render positioning

## Technical Notes

### Separator References
Separators use `make_ref()` for unique IDs, which means:
- Cannot be used in module attributes
- Items must be defined in functions, not as compile-time constants

### Boolean Operators
Used `&&` instead of `and` when checking function values alongside booleans:
```elixir
# Correct
if state.on_select && not Map.get(item, :disabled, false)

# Incorrect (raises BadBooleanError)
if state.on_select and not Map.get(item, :disabled, false)
```

### Overlay Structure
Context menu returns a custom overlay structure for renderer integration:
```elixir
%{
  type: :overlay,
  content: content,
  x: pos_x,
  y: pos_y,
  z: 100
}
```

## Files Changed

### New Files
- `lib/term_ui/widgets/tabs.ex` (330 lines)
- `lib/term_ui/widgets/menu.ex` (466 lines)
- `lib/term_ui/widgets/context_menu.ex` (290 lines)
- `test/term_ui/widgets/tabs_test.exs` (260 lines)
- `test/term_ui/widgets/menu_test.exs` (345 lines)
- `test/term_ui/widgets/context_menu_test.exs` (325 lines)

## Dependencies

All widgets use the existing infrastructure:
- `TermUI.StatefulComponent` - State management behaviour
- `TermUI.Event.Key` / `TermUI.Event.Mouse` - Event handling
- Render helpers (`text`, `styled`, `stack`, `empty`)

## Usage Examples

### Tabs
```elixir
Tabs.new(
  tabs: [
    %{id: :home, label: "Home", content: home_view()},
    %{id: :settings, label: "Settings", content: settings_view()}
  ],
  on_change: fn tab_id -> Logger.info("Switched to #{tab_id}") end
)
```

### Menu
```elixir
Menu.new(
  items: [
    Menu.action(:new, "New", shortcut: "Ctrl+N"),
    Menu.separator(),
    Menu.submenu(:recent, "Recent", [
      Menu.action(:file1, "document.txt")
    ]),
    Menu.checkbox(:autosave, "Auto Save", checked: true)
  ],
  on_select: &handle_action/1,
  on_toggle: &handle_toggle/2
)
```

### Context Menu
```elixir
ContextMenu.new(
  items: [
    ContextMenu.action(:cut, "Cut", shortcut: "Ctrl+X"),
    ContextMenu.action(:copy, "Copy", shortcut: "Ctrl+C"),
    ContextMenu.separator(),
    ContextMenu.action(:paste, "Paste", shortcut: "Ctrl+V")
  ],
  position: {click_x, click_y},
  on_select: &handle_context_action/1,
  on_close: fn -> dismiss_overlay() end
)
```

## Status

- Implementation: Complete
- Tests: 84 tests passing
- Documentation: Complete (moduledocs and function docs)
