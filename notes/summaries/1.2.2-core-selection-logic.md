# Summary: Task 1.2.2 - Core Selection Logic

## Branch
`feature/1.2.2-core-selection-logic` (from `multi-renderer`)

## What Was Implemented

Implemented the core selection logic in `try_raw_mode/0` that attempts to start raw mode using `:shell.start_interactive({:noshell, :raw})` and falls back to TTY mode when unavailable.

### Files Modified
- `lib/term_ui/backend/selector.ex` - Implemented `try_raw_mode/0` and `attempt_raw_mode/0`
- `test/term_ui/backend/selector_test.exs` - Added 10 new tests (28 total)
- `notes/features/1.2.2-core-selection-logic.md` - Working plan
- `notes/planning/multi-renderer/phase-01-backend-selector.md` - Marked task complete

### Implementation Details

**`try_raw_mode/0`**:
- Wraps `attempt_raw_mode/0` in try/rescue
- Catches `UndefinedFunctionError` for pre-OTP 28 systems
- Returns `{:tty, capabilities}` on rescue

**`attempt_raw_mode/0`**:
- Calls `:shell.start_interactive({:noshell, :raw})`
- On `:ok`: Returns `{:raw, %{raw_mode_started: true}}`
- On `{:error, :already_started}`: Returns `{:tty, detect_capabilities()}`
- On other errors: Returns `{:tty, capabilities}` with error info

### Return Values

```elixir
# Raw mode success
{:raw, %{raw_mode_started: true}}

# TTY fallback (shell already running)
{:tty, %{colors: ..., unicode: ..., dimensions: ..., terminal: ...}}
```

## Test Results
All 28 tests pass:
- 18 existing tests for module structure, documentation, types
- 10 new tests for core selection logic:
  - `try_raw_mode/0` return format tests
  - `attempt_raw_mode/0` behavior tests
  - Pre-OTP 28 fallback tests
  - Raw mode state format tests
  - Integration tests with `select/0`

## Tasks Completed
- [x] 1.2.2.1 Implement `select/0` calling `:shell.start_interactive({:noshell, :raw})`
- [x] 1.2.2.2 Handle `:ok` return by returning `{:raw, %{raw_mode_started: true}}`
- [x] 1.2.2.3 Handle `{:error, :already_started}` return with TTY fallback
- [x] 1.2.2.4 Wrap call in try/rescue for pre-OTP 28 systems

## Next Steps
- Task 1.2.3: Implement TTY capability detection (`detect_capabilities/0`)
- Task 1.2.4: Implement explicit selection tests
