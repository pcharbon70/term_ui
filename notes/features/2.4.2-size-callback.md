# Feature: Task 2.4.2 - Implement size/1 Callback

**Branch:** `feature/2.4.2-size-callback`
**Base:** `multi-renderer`
**Date:** 2025-12-05

## Overview

Implement the `size/1` callback for the Raw backend to query terminal dimensions. This callback returns the cached size from state.

## Reference

See `notes/planning/multi-renderer/phase-02-raw-backend.md` Section 2.4.2.

## Tasks

### Implementation

- [ ] 2.4.2.1 Implement `@impl true` `size/1` accepting state
- [ ] 2.4.2.2 Return `{:ok, state.size}` from cached state

### Note on Subtasks 2.4.2.3-4

Subtasks 2.4.2.3 (refresh_size/1) and 2.4.2.4 (error handling) are more fully covered in Task 2.4.3. This task focuses on the size/1 query callback which returns cached dimensions.

### Unit Tests

- [ ] Test `size/1` returns `{:ok, {rows, cols}}` tuple
- [ ] Test `size/1` returns cached dimensions from state
- [ ] Test `size/1` works with different terminal sizes

## Implementation Details

### Current State

The `size/1` function already exists as a stub that returns `{:ok, state.size}`. The implementation is essentially complete but needs:
1. Better documentation
2. Comprehensive tests

### Existing Code (raw.ex)

```elixir
@impl true
@doc """
Returns the current terminal dimensions.

Returns cached size from state. Use `refresh_size/1` to re-query.
"""
@spec size(t()) :: {:ok, TermUI.Backend.size()} | {:error, :enotsup}
def size(state) do
  # Stub - will be implemented in Task 2.4.2
  {:ok, state.size}
end
```

The stub is already correct! Just need to:
1. Remove the "Stub" comment
2. Add better documentation
3. Add tests

## Files to Modify

- `lib/term_ui/backend/raw.ex` - Update size/1 documentation
- `test/term_ui/backend/raw_test.exs` - Add size/1 tests

## Verification

1. `mix compile` - no warnings
2. `mix test test/term_ui/backend/raw_test.exs` - all tests pass
3. `mix format --check-formatted` - code formatted
