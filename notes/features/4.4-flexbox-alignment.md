# Feature Plan: 4.4 Flexbox-Inspired Alignment

## Problem Statement

After the solver allocates space to components, we need to control how components are positioned within that allocated space. Without alignment:
- Components always start at the top-left of their allocated area
- Space distribution between components is not possible
- Cross-axis positioning requires manual calculation
- Margins and padding cannot be expressed declaratively

Flexbox-inspired alignment provides familiar, powerful positioning controls.

## Solution Overview

Implement Flexbox-inspired alignment for positioning within allocated space:
- **Justify Content** - distribute on main axis (start, center, end, space-between, space-around)
- **Align Items** - position on cross axis (start, center, end, stretch)
- **Align Self** - per-component override of container alignment
- **Margin/Padding** - spacing outside and inside components

### Key Design Decisions

- **Familiar API** - follow Flexbox naming for developer familiarity
- **Main/Cross axis** - direction determines which is which
- **Post-solver adjustment** - alignment modifies solved positions
- **Pure functions** - alignment functions are stateless

## Technical Details

### File Structure

```
lib/term_ui/layout/
├── constraint.ex           # Constraint types (completed)
├── solver.ex               # Constraint solver (completed)
├── cache.ex                # Layout cache (completed)
└── alignment.ex            # Alignment functions

test/term_ui/layout/
├── constraint_test.exs     # (completed)
├── solver_test.exs         # (completed)
├── cache_test.exs          # (completed)
└── alignment_test.exs      # Alignment tests
```

### Dependencies

- Section 4.2 Constraint Solver (completed)
- Section 4.3 Layout Cache (completed)
- Will be used by Container components

## Implementation Plan

### Task 4.4.1: Justify Content

Distribute components along the main axis.

- [x] 4.4.1.1 Implement `justify: :start` positioning components at axis start
- [x] 4.4.1.2 Implement `justify: :center` centering components in available space
- [x] 4.4.1.3 Implement `justify: :end` positioning components at axis end
- [x] 4.4.1.4 Implement `justify: :space_between` distributing space between components
- [x] 4.4.1.5 Implement `justify: :space_around` distributing space around components

### Task 4.4.2: Align Items

Position components on the cross axis.

- [x] 4.4.2.1 Implement `align: :start` positioning at cross-axis start
- [x] 4.4.2.2 Implement `align: :center` centering on cross-axis
- [x] 4.4.2.3 Implement `align: :end` positioning at cross-axis end
- [x] 4.4.2.4 Implement `align: :stretch` expanding to fill cross-axis

### Task 4.4.3: Align Self

Per-component cross-axis alignment override.

- [x] 4.4.3.1 Implement `align_self` prop on components
- [x] 4.4.3.2 Override container alignment when align_self specified
- [x] 4.4.3.3 Support `:auto` value inheriting container alignment
- [x] 4.4.3.4 Apply alignment during position calculation

### Task 4.4.4: Margin and Padding

Spacing outside and inside components.

- [x] 4.4.4.1 Implement margin props: `margin`, `margin_top/right/bottom/left`
- [x] 4.4.4.2 Implement padding props: `padding`, `padding_top/right/bottom/left`
- [x] 4.4.4.3 Implement shorthand parsing: single value, vertical/horizontal, four values
- [x] 4.4.4.4 Integrate margin/padding into position calculation

### Unit Tests

- [x] Test justify start positions at beginning
- [x] Test justify center positions in middle
- [x] Test justify end positions at end
- [x] Test justify space_between distributes evenly
- [x] Test justify space_around adds space around each
- [x] Test align positions on cross axis correctly
- [x] Test stretch expands to fill cross axis
- [x] Test align_self overrides container alignment
- [x] Test margin adds space outside component
- [x] Test padding reduces content area

## Success Criteria

1. All justify options position components correctly on main axis
2. All align options position components correctly on cross axis
3. align_self properly overrides container alignment
4. Margin and padding work with all alignment combinations
5. All unit tests pass

## Current Status

**Status**: Complete

### How to Run
```bash
mix test test/term_ui/layout/alignment_test.exs
```

## Notes

### Axis Model

```
Horizontal direction (row):
- Main axis: X (left to right)
- Cross axis: Y (top to bottom)

Vertical direction (column):
- Main axis: Y (top to bottom)
- Cross axis: X (left to right)
```

### Example Usage

```elixir
alias TermUI.Layout.Alignment

# Apply justify and align to solved rects
rects = Solver.solve_to_rects(constraints, area)
aligned = Alignment.apply(rects, area,
  direction: :horizontal,
  justify: :space_between,
  align: :center
)

# With per-component align_self
aligned = Alignment.apply(rects, area,
  direction: :horizontal,
  align: :start,
  align_self: [nil, :center, :end]  # per-component overrides
)

# Parse margin/padding
margin = Alignment.parse_spacing(10)
# => %{top: 10, right: 10, bottom: 10, left: 10}

margin = Alignment.parse_spacing({5, 10})
# => %{top: 5, right: 10, bottom: 5, left: 10}

margin = Alignment.parse_spacing({1, 2, 3, 4})
# => %{top: 1, right: 2, bottom: 3, left: 4}
```
