# Feature Plan: Section 6.5 - Scrollable Content Widgets

## Problem Statement

TermUI needs widgets to handle content larger than display area. Viewport scrolls arbitrary content with scroll position tracking. ScrollBar provides visual indication and interaction for scrolling. Canvas enables direct drawing for custom rendering. These patterns enable complex content layouts.

## Solution Overview

Implement three scrollable content widgets:

1. **Viewport Widget** - Scrollable view of larger content
2. **ScrollBar Widget** - Visual scroll indicator and control
3. **Canvas Widget** - Direct buffer access for custom drawing

### Key Design Decisions

- **StatefulComponent-based** - Maintain scroll position and state
- **Clipping** - Content outside viewport bounds not rendered
- **Scroll bars** - Visual feedback with click/drag interaction
- **Canvas primitives** - Line, rect, text drawing functions

## Technical Details

### File Structure

```
lib/term_ui/widgets/
├── viewport.ex      # Viewport widget
├── scroll_bar.ex    # ScrollBar widget
└── canvas.ex        # Canvas widget
```

### Dependencies

- `TermUI.StatefulComponent` - Behaviour for stateful widgets
- `TermUI.Component.RenderNode` - Render tree builders
- `TermUI.Event` - Keyboard and mouse events

## Implementation Plan

### Task 6.5.1: Viewport Widget

- [x] 6.5.1.1 Implement content area larger than viewport
- [x] 6.5.1.2 Implement scroll position tracking
- [x] 6.5.1.3 Implement content clipping to viewport bounds
- [x] 6.5.1.4 Implement scroll bars (vertical and horizontal)
- [x] 6.5.1.5 Implement scroll bar interaction (click and drag)

### Task 6.5.2: ScrollBar Widget

- [x] 6.5.2.1 Implement scroll bar rendering with track and thumb
- [x] 6.5.2.2 Implement thumb size proportional to visible fraction
- [x] 6.5.2.3 Implement drag scrolling moving content
- [x] 6.5.2.4 Implement track click scrolling by page

### Task 6.5.3: Canvas Widget

- [x] 6.5.3.1 Implement canvas with direct buffer access
- [x] 6.5.3.2 Implement drawing primitives: `draw_line`, `draw_rect`, `draw_text`
- [x] 6.5.3.3 Implement Braille drawing for sub-character graphics
- [x] 6.5.3.4 Implement clear and fill operations
- [x] 6.5.3.5 Implement custom render callback for application drawing

### Unit Tests

- [x] Test viewport clips content to bounds
- [x] Test viewport scrolls with keyboard and mouse
- [x] Test scroll bar thumb size reflects content ratio
- [x] Test scroll bar drag updates scroll position
- [x] Test canvas draws primitives correctly
- [x] Test Braille drawing produces correct patterns

## Success Criteria

1. Viewport correctly clips and scrolls content
2. Scroll bars reflect scroll position accurately
3. Canvas drawing primitives work correctly
4. All keyboard/mouse interactions work
5. All unit tests pass

## Current Status

- **Planning**: Complete
- **Implementation**: Complete
- **Tests**: Complete (90 tests passing)
