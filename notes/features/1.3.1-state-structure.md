# Feature 1.3.1: Define State Structure

## Overview

Create the `TermUI.Backend.State` module with a struct that wraps backend-specific state with common metadata. This provides consistent state management across different backend implementations.

## Reference

- Phase plan: `notes/planning/multi-renderer/phase-01-backend-selector.md`
- Task: 1.3.1 Define State Structure

## Subtasks

- [x] 1.3.1.1 Create `lib/term_ui/backend/state.ex` with `defstruct`
- [x] 1.3.1.2 Define field `backend_module :: module()` for the active backend
- [x] 1.3.1.3 Define field `backend_state :: term()` for backend-specific state
- [x] 1.3.1.4 Define field `mode :: :raw | :tty` for current mode
- [x] 1.3.1.5 Define field `capabilities :: map()` for detected capabilities
- [x] 1.3.1.6 Define field `size :: {rows, cols} | nil` for cached dimensions
- [x] 1.3.1.7 Define field `initialized :: boolean()` for initialization status

## Implementation Notes

### Struct Design

The state struct should:
- Use `@enforce_keys` for required fields (`backend_module`, `mode`)
- Provide sensible defaults for optional fields
- Include comprehensive type specifications
- Be documented with `@moduledoc` and `@typedoc`

### Field Descriptions

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `backend_module` | `module()` | Yes | - | The backend implementation module |
| `backend_state` | `term()` | No | `nil` | Backend-specific internal state |
| `mode` | `:raw \| :tty` | Yes | - | Current terminal mode |
| `capabilities` | `map()` | No | `%{}` | Detected terminal capabilities |
| `size` | `{pos_integer(), pos_integer()} \| nil` | No | `nil` | Cached terminal dimensions |
| `initialized` | `boolean()` | No | `false` | Whether backend is initialized |

## Testing Strategy

- Test struct creation with required fields
- Test struct creation with all fields
- Test that missing required fields raise an error
- Test default values are applied correctly
- Test type specifications with Dialyzer

## Files Modified

- `lib/term_ui/backend/state.ex` - New module
- `test/term_ui/backend/state_test.exs` - New test file
